/**
 * skylark-langx-async - The skylark JavaScript language extension library.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
!function(r,t){var e=t.define,require=t.require,n="function"==typeof e&&e.amd,o=!n&&"undefined"!=typeof exports;if(!n&&!e){var i={};e=t.define=function(r,t,e){"function"==typeof e?(i[r]={factory:e,deps:t.map(function(t){return function(r,t){if("."!==r[0])return r;var e=t.split("/"),n=r.split("/");e.pop();for(var o=0;o<n.length;o++)"."!=n[o]&&(".."==n[o]?e.pop():e.push(n[o]));return e.join("/")}(t,r)}),resolved:!1,exports:null},require(r)):i[r]={factory:null,resolved:!0,exports:e}},require=t.require=function(r){if(!i.hasOwnProperty(r))throw new Error("Module "+r+" has not been defined");var module=i[r];if(!module.resolved){var e=[];module.deps.forEach(function(r){e.push(require(r))}),module.exports=module.factory.apply(t,e)||null,module.resolved=!0}return module.exports}}if(!e)throw new Error("The module utility (ex: requirejs or skylark-utils) is not loaded!");if(function(r,require){r("skylark-langx-async/async",["skylark-langx-ns"],function(r){return r.attach("langx.async")}),r(["skylark-langx-arrays","skylark-langx-funcs","skylark-langx-objects","./async"],function(t,e,n,o){"use strict";var i=Array.prototype.slice,s=e.proxy,u=t.makeArray,c=n.result,a=n.mixin;a(Promise.prototype,{always:function(r){return this.then(r,r),this},done:function(){for(var r=0;r<arguments.length;r++)this.then(arguments[r]);return this},fail:function(t){return r(["skylark-langx-arrays","skylark-langx-funcs","skylark-langx-objects"],function(r,t,e){var n=Array.prototype.slice,o=t.proxy,i=r.makeArray,s=e.result,u=e.mixin;u(Promise.prototype,{always:function(r){return this.then(r,r),this},done:function(){for(var r=0;r<arguments.length;r++)this.then(arguments[r]);return this},fail:function(r){return this.catch(r),this}});var c=function(){var r=this;this.promise=a(new Promise(function(t,e){r._resolve=t,r._reject=e}))};function a(r){if(r.isResolved)return r;var t=!0,e=!1,n=!1,o=r.then(function(r){return n=!0,t=!1,r},function(r){throw e=!0,t=!1,r});o.isResolved=function(){return n},o.isPending=function(){return t},o.isRejected=function(){return e},o.state=function(){return n?"resolved":e?"rejected":"pending"};var i=[],s=[];return o.then=function(r,t,e){return e&&this.progress(e),a(Promise.prototype.then.call(this,r&&function(t){return t&&void 0!==t.__ctx__?r.apply(t.__ctx__,t):r(t)},t&&function(r){return r&&void 0!==r.__ctx__?t.apply(r.__ctx__,r):t(r)}))},o.progress=function(r){return i.forEach(function(t){r(t)}),s.push(r),this},o.pipe=o.then,o.notify=function(r){try{return i.push(r),s.forEach(function(t){return t(r)})}catch(r){this.reject(r)}return this},o.notifyWith=function(r,t){try{return i.push(t),s.forEach(function(e){return e.call(r,t)})}catch(r){this.reject(r)}return this},o}return c.prototype.resolve=function(r){var t=n.call(arguments);return this.resolveWith(null,t)},c.prototype.resolveWith=function(r,t){return(t=t?i(t):[]).__ctx__=r,this._resolve(t),this._resolved=!0,this},c.prototype.notify=function(r){var t=s(this,"promise");return t.notify(r),this},c.prototype.reject=function(r){var t=n.call(arguments);return this.rejectWith(null,t)},c.prototype.rejectWith=function(r,t){return(t=t?i(t):[]).__ctx__=r,this._reject(t),this._rejected=!0,this},c.prototype.isResolved=function(){var r=s(this,"promise");return r.isResolved()},c.prototype.isRejected=function(){var r=s(this,"promise");return r.isRejected()},c.prototype.state=function(){var r=s(this,"promise");return r.state()},c.prototype.then=function(r,t,e){var n=s(this,"promise");return n.then(r,t,e)},c.prototype.progress=function(r){var t=s(this,"promise");return t.progress(r)},c.prototype.catch=function(r){var t=s(this,"promise");return t.catch(r)},c.prototype.always=function(){var r=s(this,"promise");return r.always.apply(r,arguments),this},c.prototype.done=function(){var r=s(this,"promise");return r.done.apply(r,arguments),this},c.prototype.fail=function(r){var t=s(this,"promise");return t.fail(r),this},c.all=function(r){var t=new c;return Promise.all(r).then(t.resolve.bind(t),t.reject.bind(t)),s(t,"promise")},c.first=function(r){return a(Promise.race(r))},c.when=function(r,t,e,n){var i=r&&"function"==typeof r.then,s=i&&r instanceof Promise;if(!i)return arguments.length>1?t?t(r):r:(new c).resolve(r);if(!s){var u=new c(r.cancel);r.then(o(u.resolve,u),o(u.reject,u),u.notify),r=u.promise}return t||e||n?r.then(t,e,n):r},c.reject=function(r){var t=new c;return t.reject(r),t.promise},c.immediate=c.resolve=function(r){var t=new c;return t.resolve.apply(t,arguments),t.promise},c.promise=function(r){var t=new c;return r(t.resolve.bind(t),t.reject.bind(t),t.progress.bind(t)),t.promise},c}),this.catch(t),this}});var l=function(){var r=this;this.promise=p(new Promise(function(t,e){r._resolve=t,r._reject=e}))};function p(r){if(r.isResolved)return r;var t=!0,e=!1,n=!1,o=r.then(function(r){return n=!0,t=!1,r},function(r){throw e=!0,t=!1,r});o.isResolved=function(){return n},o.isPending=function(){return t},o.isRejected=function(){return e},o.state=function(){return n?"resolved":e?"rejected":"pending"};var i=[],s=[];return o.then=function(r,t,e){return e&&this.progress(e),p(Promise.prototype.then.call(this,r&&function(t){return t&&void 0!==t.__ctx__?r.apply(t.__ctx__,t):r(t)},t&&function(r){return r&&void 0!==r.__ctx__?t.apply(r.__ctx__,r):t(r)}))},o.progress=function(r){return i.forEach(function(t){r(t)}),s.push(r),this},o.pipe=o.then,o.notify=function(r){try{return i.push(r),s.forEach(function(t){return t(r)})}catch(r){this.reject(r)}return this},o}return l.prototype.resolve=function(r){var t=i.call(arguments);return this.resolveWith(null,t)},l.prototype.resolveWith=function(r,t){return(t=t?u(t):[]).__ctx__=r,this._resolve(t),this._resolved=!0,this},l.prototype.notify=function(r){var t=c(this,"promise");return t.notify(r),this},l.prototype.reject=function(r){var t=i.call(arguments);return this.rejectWith(null,t)},l.prototype.rejectWith=function(r,t){return(t=t?u(t):[]).__ctx__=r,this._reject(t),this._rejected=!0,this},l.prototype.isResolved=function(){var r=c(this,"promise");return r.isResolved()},l.prototype.isRejected=function(){var r=c(this,"promise");return r.isRejected()},l.prototype.state=function(){var r=c(this,"promise");return r.state()},l.prototype.then=function(r,t,e){var n=c(this,"promise");return n.then(r,t,e)},l.prototype.progress=function(r){var t=c(this,"promise");return t.progress(r)},l.prototype.catch=function(r){var t=c(this,"promise");return t.catch(r)},l.prototype.always=function(){var r=c(this,"promise");return r.always.apply(r,arguments),this},l.prototype.done=function(){var r=c(this,"promise");return r.done.apply(r,arguments),this},l.prototype.fail=function(r){var t=c(this,"promise");return t.fail(r),this},l.all=function(r){var t=new l;return Promise.all(r).then(t.resolve.bind(t),t.reject.bind(t)),c(t,"promise")},l.first=function(r){return p(Promise.race(r))},l.when=function(r,t,e,n){var o=r&&"function"==typeof r.then,i=o&&r instanceof Promise;if(!o)return arguments.length>1?t?t(r):r:(new l).resolve(r);if(!i){var u=new l(r.cancel);r.then(s(u.resolve,u),s(u.reject,u),u.notify),r=u.promise}return t||e||n?r.then(t,e,n):r},l.reject=function(r){var t=new l;return t.reject(r),t.promise},l.immediate=l.resolve=function(r){var t=new l;return t.resolve.apply(t,arguments),t.promise},l.promise=function(r){var t=new l;return r(t.resolve.bind(t),t.reject.bind(t),t.progress.bind(t)),t.promise},o.Deferred=l}),r("skylark-langx-async/each",["./async"],function(r){return r.each=function(r,t,e){if(0===r.length)return e(void 0,r);var n=new Array(r.length),o=0,i=!1;r.forEach(function(s,u){t(s,function(t,s){if(!i)return t?(i=!0,e(t)):(n[u]=s,(o+=1)===r.length?e(void 0,n):void 0)})})}}),r("skylark-langx-async/parallel",["skylark-langx-objects","./async","./deferred"],function(r,t,e){return t.parallel=function(t,n,o){var i=[];return o=o||null,n=n||[],r.each(t,function(r,t){i.push(t.apply(o,n))}),e.all(i)}}),r("skylark-langx-async/series",["skylark-langx-objects","./async","./deferred"],function(r,t,e){return t.series=function(t,n,o){var i=[],s=new e,u=s.promise;return o=o||null,n=n||[],s.resolve(),r.each(t,function(r,t){u=u.then(function(){return t.apply(o,n)}),i.push(u)}),e.all(i)}}),r("skylark-langx-async/waterful",["skylark-langx-objects","./async","./deferred"],function(r,t,e){return t.waterful=function(t,n,o){var i=new e,s=i.promise;return o=o||null,n=n||[],i.resolveWith(o,n),r.each(t,function(r,t){s=s.then(t)}),s}}),r("skylark-langx-async/main",["./async","./deferred","./each","./parallel","./series","./waterful"],function(r){return r}),r("skylark-langx-async",["skylark-langx-async/main"],function(r){return r})}(e),!n){var s=require("skylark-langx-ns");o?module.exports=s:t.skylarkjs=s}}(0,this);
//# sourceMappingURL=sourcemaps/skylark-langx-async.js.map
